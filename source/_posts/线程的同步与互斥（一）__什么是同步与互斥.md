---
layout: 多线程
title: 线程的同步与互斥（一）__什么是同步与互斥
date: 2019-05-05 21:16:24
tags:
    - 多线程
---

## 线程的同步与互斥
> 线程（英语：thread）是操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中的实际运作单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。

### 什么是线程的同步&互斥

当有多个线程的时候，经常需要去同步这些线程以访问同一个数据或资源。例如在图像的处理过程中，可能会有一个解码线程和一个显示线程，需要在解码线程中解码原始码流，然后在渲染线程显示解码后数据。在解码前去显示数据是没有意义的，但是因为解码和渲染有自己的线程，操作系统会把两个线程当作是不相干的任务分别执行，这样就有可能造成在解码还没有完成就去渲染数据的情况，所以需要线程同步。

所谓同步，就是不同线程之间的若干程序片段，必须按照严格的先后秩序运行，这种先后秩序需要依赖特定的任务。同步大部分情况下是建立在互斥的基础上的。可以理解为，同步是一种更为复杂的互斥。

所谓互斥，是指散布在不同线程之间的若干程序片断，当某个进程运行其中一个程序片段时，其它进程就不能运行它们之中的任一程序片段，只能等到该进程运行完这个程序片段后才可以运行。但互斥无法限制访问者对资源的访问顺序，即访问是无序的。比如在视频播放过程中需要截一张图，倘若截图过程中，视频已经播放到下一帧，那截下来的图像就会有异常，或者不是用户真正想要截取的图像。所以程序需要保证在截图过程中视频不再播放，也就用到了互斥操作。

### 同步和互斥的几种方法

用户模式下的方法有：原子操作（例如一个单一的全局变量），临界区。

内核模式下的方法有：事件，信号量，互斥量。

* 临界区:通过对多线程的串行化来访问公共资源或一段代码，速度快，适合控制数据访问。
* 互斥量:为协调共同对一个共享资源的单独访问而设计的。
* 信号量:为控制一个具有有限数量用户资源而设计。
* 事 件 : 用来通知线程有一些事件已发生，从而启动后继任务的开始。
